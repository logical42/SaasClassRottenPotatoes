/**
* @preserve Copyright 2012 Twitter, Inc.
* @license http://www.apache.org/licenses/LICENSE-2.0.txt
*/
var HoganTemplate=function(){function a(a){this.text=a}function b(a){return a=String(a===null?"":a),h.test(a)?a.replace(c,"&amp;").replace(d,"&lt;").replace(e,"&gt;").replace(f,"&#39;").replace(g,"&quot;"):a}a.prototype={r:function(a,b,c){return""},v:b,render:function(a,b,c){return this.r(a,b,c)},rp:function(a,b,c,d){var e=c[a];return e?e.r(b,c,d):""},rs:function(a,b,c){var d="",e=a[a.length-1];if(!i(e))return d=c(a,b);for(var f=0;f<e.length;f++)a.push(e[f]),d+=c(a,b),a.pop();return d},s:function(a,b,c,d,e,f,g){var h;return i(a)&&a.length===0?!1:(!d&&typeof a=="function"&&(a=this.ls(a,b,c,e,f,g)),h=a===""||!!a,!d&&h&&b&&b.push(typeof a=="object"?a:b[b.length-1]),h)},d:function(a,b,c,d){var e=a.split("."),f=this.f(e[0],b,c,d),g=null;if(a==="."&&i(b[b.length-2]))return b[b.length-1];for(var h=1;h<e.length;h++)f&&typeof f=="object"&&e[h]in f?(g=f,f=f[e[h]]):f="";return d&&!f?!1:(!d&&typeof f=="function"&&(b.push(g),f=this.lv(f,b,c),b.pop()),f)},f:function(a,b,c,d){var e=!1,f=null,g=!1;for(var h=b.length-1;h>=0;h--){f=b[h];if(f&&typeof f=="object"&&a in f){e=f[a],g=!0;break}}return g?(!d&&typeof e=="function"&&(e=this.lv(e,b,c)),e):d?!1:""},ho:function(a,b,c,d,e){var f=a.call(b,d,function(a){return Hogan.compile(a,{delimiters:e}).render(b,c)}),g=Hogan.compile(f.toString(),{delimiters:e}).render(b,c);return this.b=g,!1},b:"",ls:function(a,b,c,d,e,f){var g=b[b.length-1],h=a.call(g);return a.length>0?this.ho(a,g,c,this.text.substring(d,e),f):typeof h=="function"?this.ho(h,g,c,this.text.substring(d,e),f):h},lv:function(a,b,c){var d=b[b.length-1];return Hogan.compile(a.call(d).toString()).render(d,c)}};var c=/&/g,d=/</g,e=/>/g,f=/\'/g,g=/\"/g,h=/[&<>\"\']/,i=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"};return a}(),Hogan=function(){function a(a,d){function e(){p.length>0&&(r.push(new String(p)),p="")}function f(){var a=!0;for(var b=u;b<r.length;b++){a=r[b].tag&&v[r[b].tag]<v._v||!r[b].tag&&r[b].match(q)===null;if(!a)return!1}return a}function g(a,b){e();if(a&&f())for(var c=u,d;c<r.length;c++)r[c].tag||((d=r[c+1])&&d.tag==">"&&(d.indent=r[c].toString()),r.splice(c,1));else b||r.push({tag:"\n"});s=!1,u=r.length}function h(a,c){var d="="+x,e=a.indexOf(d,c),f=b(a.substring(a.indexOf("=",c)+1,e)).split(" ");return w=f[0],x=f[1],e+d.length-1}var i=a.length,j=0,k=1,l=2,m=j,n=null,o=null,p="",r=[],s=!1,t=0,u=0,w="{{",x="}}";d&&(d=d.split(" "),w=d[0],x=d[1]);for(t=0;t<i;t++)m==j?c(w,a,t)?(--t,e(),m=k):a.charAt(t)=="\n"?g(s):p+=a.charAt(t):m==k?(t+=w.length-1,o=v[a.charAt(t+1)],n=o?a.charAt(t+1):"_v",n=="="?(t=h(a,t),m=j):(o&&t++,m=l),s=t):c(x,a,t)?(r.push({tag:n,n:b(p),otag:w,ctag:x,i:n=="/"?s-x.length:t+w.length}),p="",t+=x.length-1,m=j,n=="{"&&t++):p+=a.charAt(t);return g(s,!0),r}function b(a){return a.trim?a.trim():a.replace(/^\s*|\s*$/g,"")}function c(a,b,c){if(b.charAt(c)!=a.charAt(0))return!1;for(var d=1,e=a.length;d<e;d++)if(b.charAt(c+d)!=a.charAt(d))return!1;return!0}function d(a,b,c,g){var h=[],i=null,j=null;while(a.length>0){j=a.shift();if(j.tag=="#"||j.tag=="^"||e(j,g))c.push(j),j.nodes=d(a,j.tag,c,g),h.push(j);else{if(j.tag=="/"){if(c.length===0)throw new Error("Closing tag without opener: /"+j.n);i=c.pop();if(j.n!=i.n&&!f(j.n,i.n,g))throw new Error("Nesting error: "+i.n+" vs. "+j.n);return i.end=j.i,h}h.push(j)}}if(c.length>0)throw new Error("missing closing tag: "+c.pop().n);return h}function e(a,b){for(var c=0,d=b.length;c<d;c++)if(b[c].o==a.n)return a.tag="#",!0}function f(a,b,c){for(var d=0,e=c.length;d<e;d++)if(c[d].c==a&&c[d].o==b)return!0}function g(a,b,c){var d='i = i || "";var c = [cx];var b = i + "";var _ = this;'+j(a)+"return b;";if(c.asString)return"function(cx,p,i){"+d+";}";var e=new HoganTemplate(b);return e.r=new Function("cx","p","i",d),e}function h(a){return a.replace(u,"\\\\").replace(r,'\\"').replace(s,"\\n").replace(t,"\\r")}function i(a){return~a.indexOf(".")?"d":"f"}function j(a){var b="";for(var c=0,d=a.length;c<d;c++){var e=a[c].tag;e=="#"?b+=k(a[c].nodes,a[c].n,i(a[c].n),a[c].i,a[c].end,a[c].otag+" "+a[c].ctag):e=="^"?b+=l(a[c].nodes,a[c].n,i(a[c].n)):e=="<"||e==">"?b+=m(a[c]):e=="{"||e=="&"?b+=n(a[c].n,i(a[c].n)):e=="\n"?b+=p('"\\n"'+(a.length-1==c?"":" + i")):e=="_v"?b+=o(a[c].n,i(a[c].n)):e===undefined&&(b+=p('"'+h(a[c])+'"'))}return b}function k(a,b,c,d,e,f){return"if(_.s(_."+c+'("'+h(b)+'",c,p,1),'+"c,p,0,"+d+","+e+', "'+f+'")){'+"b += _.rs(c,p,"+'function(c,p){ var b = "";'+j(a)+"return b;});c.pop();}"+'else{b += _.b; _.b = ""};'}function l(a,b,c){return"if (!_.s(_."+c+'("'+h(b)+'",c,p,1),c,p,1,0,0,"")){'+j(a)+"};"}function m(a){return'b += _.rp("'+h(a.n)+'",c[c.length - 1],p,"'+(a.indent||"")+'");'}function n(a,b){return"b += (_."+b+'("'+h(a)+'",c,p,0));'}function o(a,b){return"b += (_.v(_."+b+'("'+h(a)+'",c,p,0)));'}function p(a){return"b += "+a+";"}var q=/\S/,r=/\"/g,s=/\n/g,t=/\r/g,u=/\\/g,v={"#":1,"^":2,"/":3,"!":4,">":5,"<":6,"=":7,_v:8,"{":9,"&":10};return{scan:a,parse:function(a,b){return b=b||{},d(a,"",[],b.sectionTags||[])},cache:{},compile:function(b,c){c=c||{};var d=this.cache[b];return d?d:(d=g(this.parse(a(b,c.delimiters),c),b,c),this.cache[b]=d)}}}();typeof module!="undefined"&&module.exports?(module.exports=Hogan,module.exports.Template=HoganTemplate):typeof define=="function"&&define.amd?define(function(){return Hogan}):typeof exports!="undefined"&&(exports.Hogan=Hogan,exports.HoganTemplate=HoganTemplate);